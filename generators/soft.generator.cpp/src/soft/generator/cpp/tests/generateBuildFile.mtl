[comment encoding = UTF-8 /]
[module generateBuildFile('http://www.eclipse.org/emf/2002/Ecore')/]

[import soft::generator::cpp::generateCommon/]
[import soft::generator::cpp::tests::generateCommon/]

[template public generateTestsBuildFile(aPackage : EPackage) { packageName : String = aPackage.name ; testName : String = packageName.concat('.tests'); }]
[file (getOutputDirectory().concat('/CMakeLists.txt'), false, 'UTF-8')]
#############################################################################
#                                                                           #
#             CMakeList created by soft.generator.cpp Generator             # 
#                                                                           #
#############################################################################

# C++ project for model [packageName/].ecore, generated by soft.generator.cpp

CMAKE_MINIMUM_REQUIRED(VERSION 3.12)

project([testName/] CXX)

include( CMakeFiles.txt OPTIONAL)

if(NOT CMAKE_BUILD_TYPE) 
    set(CMAKE_BUILD_TYPE Debug)
endif()
set(CMAKE_DEBUG_POSTFIX d)

set(CMAKE_CXX_STANDARD 14)

set(Boost_USE_STATIC_LIBS ON)
find_package(Boost 1.68.0 REQUIRED COMPONENTS unit_test_framework)
find_package(Turtle 2.3.0)

set(GENERATED_MOCK_FILES
[for (aClass : EClass | aPackage.eAllContents(EClass)->asOrderedSet()->sortedBy(name))]
    src-gen/[packageName/]/[aClass.getMockName()/].hpp
[/for] 
)

add_executable( ${PROJECT_NAME} ${TESTS_FILES} ${GENERATED_MOCK_FILES})
target_include_directories(${PROJECT_NAME} PUBLIC src)
target_include_directories(${PROJECT_NAME} PUBLIC src-gen)
target_include_directories( ${PROJECT_NAME} PUBLIC ${Boost_INCLUDE_DIRS})
target_include_directories( ${PROJECT_NAME} PUBLIC ${Turtle_INCLUDE_DIRS})
target_link_libraries(${PROJECT_NAME} [packageName/])
target_link_libraries(${PROJECT_NAME} ${Boost_UNIT_TEST_FRAMEWORK_LIBRARY})

source_group(src FILES ${TESTS_FILES})
source_group(src-gen FILES ${GENERATED_MOCK_FILES})

[/file]
[/template]


